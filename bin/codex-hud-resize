#!/usr/bin/env bash
set -e

session_name="$1"

if [[ -z "$session_name" ]]; then
    session_name=$(tmux display -p "#{session_name}" 2>/dev/null || true)
fi

if [[ -z "$session_name" ]]; then
    exit 0
fi

pane=$(tmux show-option -t "$session_name" -qv @codex_hud_pane)
height=$(tmux show-option -t "$session_name" -qv @codex_hud_height)

if [[ -z "$pane" || -z "$height" ]]; then
    exit 0
fi

current=$(tmux display -p -t "$pane" "#{pane_height}" 2>/dev/null || true)
if [[ -n "$current" && "$current" != "$height" ]]; then
    tmux resize-pane -t "$pane" -y "$height" 2>/dev/null || true
fi
